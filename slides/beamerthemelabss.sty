\mode<presentation>

\RequirePackage{fontspec}
\RequirePackage{Alegreya}
\RequirePackage[light]{AlegreyaSans}
\RequirePackage[scale=MatchLowercase,nomap]{FiraMono}

\setbeamerfont{title}{family=\rmfamily\scshape}
\setbeamerfont{frametitle}{family=\rmfamily}
\usefonttheme[onlymath]{serif}
\DeclareSymbolFont{operators}{\encodingdefault}{\familydefault}{m}{n}

\RequirePackage{xcolor}
\definecolor{labss_fg}{HTML}{F6EFE9}
\definecolor{labss_bg}{HTML}{996666}
\definecolor{labss_hl}{HTML}{284040}

\setbeamercolor{title}{fg=labss_hl}
\setbeamercolor{frametitle}{fg=labss_fg,bg=labss_bg}
\setbeamercolor{separation line}{bg=labss_bg!50!black}
\setbeamercolor{description item}{fg=black}
\setbeamercolor{section in toc}{fg=black}
\setbeamercolor{subsection in toc}{fg=black!75}

\RequirePackage{tcolorbox}
\tcbset{%
  noparskip,
  boxrule=0.25pt,
  colback=labss_fg!50, %background color of the box
  colframe=labss_fg!75!black, %color of frame and title background
  coltext=black, %color of body text
  coltitle=black, %color of title text
  fonttitle=\bfseries,
}

\usepackage{shadowtext}
\shadowoffset{0.5pt}
\shadowcolor{labss_bg!50!black}

\newcommand{\hl}[1]{\textcolor{labss_hl}{\textbf{#1}}}

\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{headline}{}
\setbeamertemplate{description item}{\bfseries\insertdescriptionitem}
\setbeamertemplate{itemize item}{\color{labss_bg!50}$\blacktriangleright$}

\setbeamertemplate{footline}{%
  \ifnum\c@framenumber=1
  \else
    \begin{beamercolorbox}[wd=0.98\paperwidth,right,dp=2ex]{page number}
      \insertframenumber/\inserttotalframenumber
    \end{beamercolorbox}
  \fi%
}

\setbeamertemplate{frametitle}{%
  \nointerlineskip%
  \begin{beamercolorbox}[wd=\paperwidth, sep=4pt, leftskip=3pt, rightskip=3pt]{frametitle}%
    \strut\shadowtext{\scshape\insertframetitle}\nolinebreak\strut
  \end{beamercolorbox}
  \nointerlineskip%
  \begin{beamercolorbox}[wd=\paperwidth, ht=0.5pt]{separation line}%
  \end{beamercolorbox}%
}

\AtBeginSection[]{%
  \begin{frame}
    \setbeamercovered{transparent}
    \frametitle{Plan}
    \tableofcontents[currentsection,hideothersubsections]
  \end{frame}
}

% https://tex.stackexchange.com/a/129544/7329
\makeatletter
\define@key{beamerframe}{wide}[1em]{%
  \def\beamer@cramped{\itemsep #1\topsep0.5pt\relax}}
\makeatother

% https://tex.stackexchange.com/a/160827/7329
\newcommand\Wider[2][3em]{%
\makebox[\linewidth][c]{%
  \begin{minipage}{\dimexpr\textwidth+#1\relax}
  \raggedright#2
  \end{minipage}%
  }%
}
